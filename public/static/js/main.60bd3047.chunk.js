(this.webpackJsonpe2e=this.webpackJsonpe2e||[]).push([[0],{76:function(t,e,n){},77:function(t,e,n){"use strict";n.r(e);var c=n(1),r=n.n(c),a=n(21),s=n.n(a),o=n(14),u=n(16),i=n(5),l=n(15),d=n(6),j=n(43),p=n(41),b=n(40),f=n(2);function O(t){var e=Object(i.f)(),n=t.product,c=n._id,r=n.title,a=n.img,s=n.price,o=e.pathname.slice(1);return Object(f.jsxs)("div",{className:"product-preview",children:[Object(f.jsxs)("div",{className:"card-product flex column justify-center align-center",children:[Object(f.jsx)("img",{src:a}),Object(f.jsx)("h1",{children:r}),Object(f.jsxs)("h2",{children:[s,"$"]})]}),"admin"===o&&Object(f.jsxs)("div",{className:"action-card flex space-evenly",children:[Object(f.jsx)(b.a,{className:"edit-btn",onClick:function(){t.onEditProduct(c)}}),Object(f.jsx)(p.a,{className:"delete-btn",onClick:function(){t.onDeleteProduct(c)}})]}),"home"===o&&Object(f.jsx)("div",{className:"action-card flex justify-center",children:Object(f.jsx)("button",{className:"btn buy-btn",onClick:function(){t.onBuyProduct(t.product)},children:"Add To Cart"})})]})}var h=function(t){var e=t.products,n=t.onDeleteProduct,c=t.onEditProduct,r=t.onBuyProduct;return Object(f.jsx)("div",{className:"product-list flex wrap",children:e.map((function(t,e){return Object(f.jsx)(O,{product:t,onDeleteProduct:n,onEditProduct:c,onBuyProduct:r},e)}))})},m=r.a.memo(h),v=function(t){var e=t.productsCart,n=t.onPay,r=Object(c.useState)(0),a=Object(d.a)(r,2),s=a[0],o=a[1];return Object(c.useEffect)((function(){var t=0;e.forEach((function(e){t+=e.price})),o(t)}),[e]),Object(f.jsx)("div",{className:"cart",children:e.length>0&&Object(f.jsxs)("ul",{className:"cart-list",children:[e.map((function(t,e){return Object(f.jsxs)("li",{className:"cart-line",children:[Object(f.jsx)("h1",{children:t.title}),Object(f.jsxs)("h2",{children:[t.price,"$"]})]},e)})),s>0&&Object(f.jsxs)("p",{className:"total-cart",children:["Total: ",Object(f.jsxs)("span",{children:[s,"$"]})]}),Object(f.jsx)("button",{className:"btn pay-btn",onClick:function(){n(s)},children:"Pay"})]})})},x=n(4),g=n.n(x),y=n(8),N=n(42),w="/api/",P=n.n(N).a.create({withCredentials:!0}),D=function(t,e){return S(t,"GET",e)},E=function(t,e){return S(t,"POST",e)},C=function(t,e){return S(t,"PUT",e)},k=function(t,e){return S(t,"DELETE",e)};function S(t){return T.apply(this,arguments)}function T(){return(T=Object(y.a)(g.a.mark((function t(e){var n,c,r,a=arguments;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"get",c=a.length>2&&void 0!==a[2]?a[2]:null,t.prev=2,t.next=5,P({url:"".concat(w).concat(e),method:n,data:c,params:"GET"===n?c:null});case 5:return r=t.sent,t.abrupt("return",r.data);case 9:throw t.prev=9,t.t0=t.catch(2),console.log("Had Issues ".concat(n,"ing to the backend, endpoint: ").concat(e,", with data: ").concat(c)),console.dir(t.t0),t.t0.response&&401===t.t0.response.status&&window.location.assign("/#/login"),t.t0;case 15:case"end":return t.stop()}}),t,null,[[2,9]])})))).apply(this,arguments)}var _={query:function(){return D("product")},getById:function(t){return D("product/".concat(t))},save:function(t){return U.apply(this,arguments)},remove:function(t){return k("product/".concat(t))},getEmptyProduct:function(){return{title:"",price:"",description:"",img:""}}};function U(){return(U=Object(y.a)(g.a.mark((function t(e){var n,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._id){t.next=7;break}return t.next=3,C("product/".concat(e._id),e);case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.next=9,E("product",e);case 9:return c=t.sent,t.abrupt("return",c);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(){return function(){var t=Object(y.a)(g.a.mark((function t(e){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_.query();case 3:n=t.sent,e({type:"SET_PRODUCTS",products:n}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log("ProductActions: err in loadProducts",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}function R(t){return function(){var e=Object(y.a)(g.a.mark((function e(n){var c,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=t._id?"UPDATE_PRODUCT":"ADD_PRODUCT",e.next=4,_.save(t);case 4:r=e.sent,n({type:c,product:r}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Product Actions: err in add product",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}var A={query:function(){return D("cart")},payCart:function(t){return E("cart/pay",t)}};var B=n(24),M=n(12),q=function(t){var e=t.productId,n=void 0===e?null:e,r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=Object(c.useState)(t),r=Object(d.a)(n,2),a=r[0],s=r[1];return Object(c.useEffect)((function(){e(a)}),[a]),[a,function(t){var e=t.target.name,n="number"===t.target.type?+t.target.value:t.target.value;s((function(t){return Object(M.a)(Object(M.a)({},t),{},Object(B.a)({},e,n))}))},s]}(_.getEmptyProduct()),a=Object(d.a)(r,3),s=a[0],u=a[1],i=a[2],l=Object(o.b)();Object(c.useEffect)((function(){return n&&j(n),function(){console.log("unmounted")}}),[]),Object(c.useEffect)((function(){return j(n),function(){console.log("unmounted")}}),[n]);var j=function(){var t=Object(y.a)(g.a.mark((function t(e){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,_.getById(e);case 3:n=t.sent,i(n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),p=function(){var t=Object(y.a)(g.a.mark((function t(e){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),l(R(s));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(f.jsx)("div",{className:"edit-product",children:Object(f.jsxs)("form",{className:"form-product flex column space-between",onSubmit:function(t){return p(t)},children:[Object(f.jsx)("div",{className:"field-input",children:Object(f.jsx)("input",{type:"text",name:"title",placeholder:"Title",value:s.title,onChange:u})}),Object(f.jsx)("div",{className:"field-input",children:Object(f.jsx)("input",{type:"number",name:"price",placeholder:"Price",value:s.price,onChange:u})}),Object(f.jsx)("div",{className:"field-input",children:Object(f.jsx)("input",{type:"text",name:"description",placeholder:"Description",value:s.description,onChange:u})}),Object(f.jsx)("div",{className:"field-input",children:Object(f.jsx)("input",{type:"text",name:"img",placeholder:"Image",value:s.img,onChange:u})}),Object(f.jsx)("button",{className:"btn save-btn",type:"submit",children:"Save"})]})})},F=n(44),L=n(45),H={calcState:function(t){var e=[],n=[],c=function(){var t=new Date((new Date).setHours(0,0,0,0));return[t.setDate(t.getDate()),t.setDate(t.getDate()-1),t.setDate(t.getDate()-1),t.setDate(t.getDate()-1),t.setDate(t.getDate()-1)].reduce((function(t,e){return t[e]=0,t}),{})}(),r=Object.keys(c),a={};t.forEach((function(t){n=[].concat(Object(l.a)(n),Object(l.a)(t.productsCart));var e=new Date(t.date).setHours(0,0,0,0);-1!==r.findIndex((function(t){return t==e}))&&(c[e]+=t.totalPrice),t.uniqeProduct.forEach((function(t){a.hasOwnProperty(t)?a["".concat(t)]+=1:a["".concat(t)]=1}))}));var s=function(t){var e={};return t.forEach((function(t){e[t.title]||(e["".concat(t.title)]=0),e["".concat(t.title)]++})),function(t){for(var e=[],n=Object.keys(t),c=Object.values(t),r=0;r<5;r++){var a=c.findIndex((function(t){return t===Math.max.apply(Math,Object(l.a)(c))})),s=n.splice(a,1).pop(),o=c.splice(a,1).pop();e.push([s,o])}return e}(e)}(n);e.push(s),e.push(a);var o=(u=c,Object.keys(u).map((function(t){var e=new Date(+t),n=e.getMonth()+1;return[String(e.getDate()).padStart(2,"0")+"."+n+"."+e.getFullYear(),u[t]]})));var u;return e.push(o),e}};var V=[{path:"/home",component:function(){var t=Object(o.b)(),e=Object(o.c)((function(t){return t.productModule.products})),n=Object(c.useState)(!1),r=Object(d.a)(n,2),a=r[0],s=r[1],u=Object(c.useState)([]),i=Object(d.a)(u,2),p=i[0],b=i[1],O=Object(c.useState)([]),h=Object(d.a)(O,2),x=h[0],g=h[1];Object(c.useEffect)((function(){return console.log("mount"),t(I()),function(){console.log("unmounted home")}}),[]);return Object(f.jsxs)("div",{className:"home",children:[e&&Object(f.jsx)(m,{products:e,onBuyProduct:function(t){b((function(e){return[].concat(Object(l.a)(e),[t])})),x.includes(t.title)||g((function(e){return[].concat(Object(l.a)(e),[t.title])}))}}),Object(f.jsxs)("div",{className:"cart-side",children:[Object(f.jsxs)("div",{className:"btn cart-btn hover-span flex",onClick:function(){s((function(t){return!t}))},children:[p.length>0&&Object(f.jsx)("span",{className:"count-product",children:p.length}),Object(f.jsx)(j.a,{})]}),a&&p.length>0&&Object(f.jsx)(v,{productsCart:p,onPay:function(t){var e={date:Date.now(),productsCart:p,uniqeProduct:x,totalPrice:t};b([]),A.payCart(e)}})]})]})}},{path:"/admin",component:function(){var t=Object(o.b)(),e=Object(o.c)((function(t){return t.productModule.products})),n=Object(c.useState)(!1),r=Object(d.a)(n,2),a=r[0],s=r[1],u=Object(c.useState)(null),i=Object(d.a)(u,2),l=i[0],j=i[1];Object(c.useEffect)((function(){return console.log("mount"),t(I()),function(){console.log("unmounted admin")}}),[]);var p=Object(c.useCallback)((function(e){t(function(t){return function(){var e=Object(y.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.remove(t);case 3:n({type:"REMOVE_PRODUCT",productId:t}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("UserActions: err in removeUser",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()}(e))}),[]),b=Object(c.useCallback)((function(t){s(!0),j("".concat(t))}),[]);return Object(f.jsxs)("div",{className:"admin",children:[e.length>0&&Object(f.jsx)(m,{products:e,onDeleteProduct:p,onEditProduct:b}),Object(f.jsxs)("div",{className:"add-product flex column",children:[Object(f.jsx)("button",{onClick:function(){j(null),s((function(t){return!t}))},className:"btn-reset right-self",children:a?Object(f.jsx)(L.a,{className:"close-btn hover-span"}):Object(f.jsx)(F.a,{className:"add-btn hover-span"})}),a&&Object(f.jsx)(q,{productId:l})]})]})}},{path:"/state",component:function(){var t=Object(c.useState)([]),e=Object(d.a)(t,2),n=e[0],r=e[1],a=Object(c.useState)(null),s=Object(d.a)(a,2),o=s[0],u=s[1],i=function(){var t=Object(y.a)(g.a.mark((function t(){var e;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,A.query();case 3:e=t.sent,r(e);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){i()}),[]),Object(c.useEffect)((function(){n.length>0&&u(H.calcState(n))}),[n]),Object(f.jsx)("div",{className:"state-page",children:o&&Object(f.jsxs)("div",{className:"states-display",children:[Object(f.jsxs)("div",{className:"modal-state",children:[Object(f.jsx)("h1",{children:"Top 5 Sold Product"}),Object(f.jsx)("ul",{className:"clean-list",children:o[0].map((function(t,e){return Object(f.jsxs)("li",{children:[t[0]," - ",t[1]]},e)}))})]}),Object(f.jsxs)("div",{className:"modal-state",children:[Object(f.jsx)("h1",{children:"Top 5 Unique Sold Product"}),Object(f.jsx)("ul",{className:"clean-list",children:Object.keys(o[1]).map((function(t,e){return Object(f.jsxs)("li",{children:[t," - ",o[1][t]]},e)}))})]}),Object(f.jsxs)("div",{className:"modal-state",children:[Object(f.jsx)("h1",{children:"Sale Last 5 Days"}),Object(f.jsx)("ul",{className:"clean-list",children:o[2].map((function(t,e){return Object(f.jsxs)("li",{children:["Date: ",t[0]," total sale: ",t[1]]},e)}))})]})]})})}}],$=function(){return Object(f.jsxs)("div",{className:"app-header flex ps-2 space-between align-center",children:[Object(f.jsxs)("p",{className:"logo",children:[Object(f.jsx)("span",{children:"W"}),"hist-",Object(f.jsx)("span",{children:"TV"})]}),Object(f.jsxs)("nav",{className:"navbar clean-list flex w-20 space-evenly",children:[Object(f.jsx)(u.b,{exact:!0,to:"/home",activeClassName:"selected",children:"Home"}),Object(f.jsx)(u.b,{exact:!0,to:"/admin",activeClassName:"selected",children:"Admin"}),Object(f.jsx)(u.b,{exact:!0,to:"/state",activeClassName:"selected",children:"State"})]})]})};function W(){return console.log("aa"),Object(f.jsx)("div",{className:"app",children:Object(f.jsxs)(u.a,{children:[Object(f.jsx)($,{}),Object(f.jsx)("main",{className:"container",children:Object(f.jsx)(i.c,{children:V.map((function(t){return Object(f.jsx)(i.a,{component:t.component,path:t.path},t.path)}))})})]})})}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(76);var G=n(17),J=n(46),X={products:[]};var Y=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||G.d,z=Object(G.c)({productModule:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_PRODUCTS":return Object(M.a)(Object(M.a)({},t),{},{products:e.products});case"ADD_PRODUCT":return Object(M.a)(Object(M.a)({},t),{},{products:[].concat(Object(l.a)(t.products),[e.product])});case"UPDATE_PRODUCT":return Object(M.a)(Object(M.a)({},t),{},{products:t.products.map((function(t){return t._id===e.product._id?e.product:t}))});case"REMOVE_PRODUCT":return Object(M.a)(Object(M.a)({},t),{},{products:t.products.filter((function(t){return t._id!==e.productId}))});default:return t}}}),K=Object(G.e)(z,Y(Object(G.a)(J.a))),Q=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,78)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,a=e.getLCP,s=e.getTTFB;n(t),c(t),r(t),a(t),s(t)}))};s.a.render(Object(f.jsx)(o.a,{store:K,children:Object(f.jsx)(W,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)})),Q()}},[[77,1,2]]]);
//# sourceMappingURL=main.60bd3047.chunk.js.map